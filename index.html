<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?lang=javascript"></script>

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            padding: 2em;
        }

        button {
            background-color: #F2F4F6;
            color: #000;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }

        pre {
            max-width: 500px;
            background: #F2F4F6;
            padding: 2px;
            border: 1px solid #E1E1E1 !important;
            margin-top: 2em;
        }

        code {
            white-space: break-spaces;
            word-break: break-all;
        }
    </style>

    <title>Notification</title>
</head>

<body onload="subscribe()">
<button onclick="subscribe()">
    Habilitar Notificação
</button>


<pre class="prettyprint">
    <code class="language-javascript" id="code"></code>
</pre>

<script onload="initComponents()">
    async function initComponents(){
        this.subscribe();
    }

    addEventListener('load', async () => {
        let sw = await navigator.serviceWorker.register('sw.js');
        console.log(sw);
    });

    async function subscribe() {
        let sw = await navigator.serviceWorker.ready;
        let subscription = await sw.pushManager.subscribe({
            userVisibleOnly: true,
            applicationServerKey: "BIYU9-MdUzL3bYjmOwuEeBlea33V18PoZ8wkMXU9qcYh1pc5dS63PVf3TEWh-mRJjnxUOZA1bexDbDcRjnoeKlU"
        });

        const content = document.getElementById('code');
        content.textContent = JSON.stringify(subscription);
    }
</script>
</body>

</html>